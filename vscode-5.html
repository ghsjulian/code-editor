<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Code Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.14/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.14/ext-language_tools.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
 <link href="css/tailwind.min.css" rel="stylesheet" />
        <script src="libs/ace.js"></script>
        <script src="libs/ext-language_tools.js"></script>
        <link href="css/custom.styles.css" rel="stylesheet" />
        <link href="css/file.explorer.css" rel="stylesheet" />
    <style>
        #editor { 
            width: 100%;
            height: calc(100vh - 2.5rem);
        }
        .sidebar {
            width: 3rem;
            background-color: #252526;
            transition: width 0.3s ease;
        }
        .sidebar:hover, .sidebar.active {
            width: 16rem;
        }
        .sidebar-icon {
            padding: 0.75rem;
            cursor: pointer;
            color: #cccccc;
        }
        .sidebar-icon:hover {
            background-color: #2d2d2d;
            color: #ffffff;
        }
        .sidebar-icon.active {
            background-color: #37373d;
            color: #ffffff;
        }
        .tree-node {
            cursor: pointer;
            user-select: none;
            padding: 0.25rem 0.5rem;
        }
        .tree-node:hover {
            background-color: #2a2d2e;
        }
        .tab {
            padding: 0.5rem 1rem;
            cursor: pointer;
            background-color: #2d2d2d;
            color: #cccccc;
        }
        .tab.active {
            background-color: #1e1e1e;
            color: #ffffff;
            border-bottom: 2px solid #007acc;
        }
        .tab:hover {
            background-color: #37373d;
        }
        .file-tree-container {
            display: none;
        }
        .sidebar.active .file-tree-container {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar flex flex-col">
            <div class="flex flex-col items-center">
                <!-- Sidebar Icons -->
                <div class="sidebar-icon active" data-panel="explorer" title="File Explorer">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path>
                    </svg>
                </div>
                <div class="sidebar-icon" data-panel="search" title="Search">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <div class="sidebar-icon" data-panel="git" title="Source Control">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 18v-4m0 0v-4m0 4h4m-4 0H8m4 4a4 4 0 100-8 4 4 0 000 8z"></path>
                    </svg>
                </div>
                <div class="sidebar-icon" data-panel="debug" title="Run and Debug">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14m0-4v4m0-4H9m6 4v4m-6-4l-4.553 2.276A1 1 0 013 15.382V8.618a1 1 0 011.447-.894L9 10m0 0v4"></path>
                    </svg>
                </div>
                <div class="sidebar-icon" data-panel="extensions" title="Extensions">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                    </svg>
                </div>
            </div>
            <!-- File Explorer Panel -->
            <div class="file-tree-container flex-1 p-2 overflow-auto">
                <div class="flex justify-between mb-2">
                    <span class="text-xs font-bold uppercase text-gray-400">Explorer</span>
                    <div class="flex space-x-1">
                        <button id="new-file" class="text-gray-400 hover:text-white" title="New File">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </button>
                        <button id="new-folder" class="text-gray-400 hover:text-white" title="New Folder">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-5 5h14a2 2 0 002-2V7a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="file-tree" class="text-sm"></div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex flex-col flex-1">
            <!-- Tabs -->
            <div class="bg-gray-800 h-10 flex items-center px-2 overflow-x-auto">
                <div id="tabs" class="flex space-x-1"></div>
            </div>
            <!-- Editor -->
            <div class="flex-1">
                <div id="editor"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Ace Editor
        const editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/javascript");
        editor.setOptions({
            enableBasicAutocompletion: true,
            enableSnippets: true,
            enableLiveAutocompletion: true
        });

        // File System Structure
        let fileSystem = {
            name: "root",
            type: "folder",
            children: [
                { name: "index.js", type: "file", content: "// Start coding here" },
                { name: "src", type: "folder", children: [
                    { name: "app.js", type: "file", content: "console.log('Hello World');" }
                ]}
            ]
        };

        let openTabs = [];
        let activeTab = null;

        // DOM Elements
        const fileTree = document.getElementById("file-tree");
        const tabsContainer = document.getElementById("tabs");
        const sidebar = document.getElementById("sidebar");
        const newFileBtn = document.getElementById("new-file");
        const newFolderBtn = document.getElementById("new-folder");
        const sidebarIcons = document.querySelectorAll(".sidebar-icon");

        // Render File Tree
        function renderFileTree(node, parentElement, path = "") {
            const div = document.createElement("div");
            div.className = "ml-2";
            const item = document.createElement("div");
            item.className = "tree-node flex items-center";
            
            if (node.type === "folder") {
                item.innerHTML = `<span class="mr-2">üìÅ</span>${node.name}`;
                const childrenDiv = document.createElement("div");
                childrenDiv.className = "ml-4 hidden";
                item.addEventListener("click", (e) => {
                    e.stopPropagation();
                    childrenDiv.classList.toggle("hidden");
                });
                div.appendChild(item);
                div.appendChild(childrenDiv);
                node.children.forEach(child => renderFileTree(child, childrenDiv, `${path}/${node.name}`));
            } else {
                item.innerHTML = `<span class="mr-2">üìÑ</span>${node.name}`;
                item.addEventListener("click", () => openFile(node, `${path}/${node.name}`));
                div.appendChild(item);
            }
            parentElement.appendChild(div);
        }

        // Open File in Editor
        function openFile(node, path) {
            if (!openTabs.find(tab => tab.path === path)) {
                openTabs.push({ node, path });
                renderTabs();
            }
            setActiveTab(path);
            editor.setValue(node.content || "");
            editor.clearSelection();
        }

        // Render Tabs
        function renderTabs() {
            tabsContainer.innerHTML = "";
            openTabs.forEach(tab => {
                const tabEl = document.createElement("div");
                tabEl.className = `tab flex items-center ${activeTab === tab.path ? "active" : ""}`;
                tabEl.innerText = tab.node.name;
                tabEl.addEventListener("click", () => setActiveTab(tab.path));
                const closeBtn = document.createElement("span");
                closeBtn.className = "ml-2 text-gray-400 hover:text-white";
                closeBtn.innerHTML = "√ó";
                closeBtn.addEventListener("click", (e) => {
                    e.stopPropagation();
                    closeTab(tab.path);
                });
                tabEl.appendChild(closeBtn);
                tabsContainer.appendChild(tabEl);
            });
        }

        // Set Active Tab
        function setActiveTab(path) {
            activeTab = path;
            const tab = openTabs.find(t => t.path === path);
            if (tab) {
                editor.setValue(tab.node.content || "");
                editor.clearSelection();
                renderTabs();
            }
        }

        // Close Tab
        function closeTab(path) {
            openTabs = openTabs.filter(tab => tab.path !== path);
            if (activeTab === path) {
                activeTab = openTabs.length > 0 ? openTabs[0].path : null;
                editor.setValue(activeTab ? openTabs[0].node.content : "");
            }
            renderTabs();
        }

        // Create New File
        newFileBtn.addEventListener("click", () => {
            const name = prompt("Enter file name:");
            if (name) {
                fileSystem.children.push({ name, type: "file", content: "" });
                refreshFileTree();
            }
        });

        // Create New Folder
        newFolderBtn.addEventListener("click", () => {
            const name = prompt("Enter folder name:");
            if (name) {
                fileSystem.children.push({ name, type: "folder", children: [] });
                refreshFileTree();
            }
        });

        // Sidebar Icon Toggle
        sidebarIcons.forEach(icon => {
            icon.addEventListener("click", () => {
                sidebarIcons.forEach(i => i.classList.remove("active"));
                icon.classList.add("active");
                sidebar.classList.add("active");
                // Placeholder for other panels (Search, Git, etc.)
                if (icon.dataset.panel !== "explorer") {
                    fileTree.innerHTML = `<div class="p-2 text-gray-400">${icon.dataset.panel.toUpperCase()} panel (not implemented)</div>`;
                } else {
                    refreshFileTree();
                }
            });
        });

        // Sidebar Hover
        sidebar.addEventListener("mouseenter", () => {
            sidebar.classList.add("active");
        });
        sidebar.addEventListener("mouseleave", () => {
            if (!document.querySelector(".sidebar-icon.active")) {
                sidebar.classList.remove("active");
            }
        });

        // Refresh File Tree
        function refreshFileTree() {
            fileTree.innerHTML = "";
            renderFileTree(fileSystem, fileTree);
        }

        // Save Editor Content to Active Tab
        editor.on("change", () => {
            if (activeTab) {
                const tab = openTabs.find(t => t.path === activeTab);
                if (tab) tab.node.content = editor.getValue();
            }
        });

        // Initial Render
        refreshFileTree();
    </script>
</body>
</html>