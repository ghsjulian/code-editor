<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Explorer with Creation</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <header>
        <div class="logo">
            <i class="fas fa-folder-tree"></i>
            <span>File Explorer</span>
        </div>
        <div class="header-actions">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search files...">
            </div>
            <div class="user-profile">
                <div class="user-avatar">JD</div>
                <i class="fas fa-chevron-down"></i>
            </div>
            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">File Structure</div>
                <i class="fas fa-ellipsis-v"></i>
            </div>
            <div class="sidebar-content">
                <ul class="file-tree" id="fileTree">
                    <!-- Dynamic content will be inserted here by JavaScript -->
                </ul>
            </div>
        </aside>

        <main class="content">
            <div class="breadcrumb" id="breadcrumb">
                <div class="breadcrumb-item active">Root</div>
            </div>
            <div class="file-actions">
                <button class="btn btn-primary" id="newFolderBtn">
                    <i class="fas fa-folder-plus"></i> New Folder
                </button>
                <button class="btn btn-primary" id="newFileBtn">
                    <i class="fas fa-file-circle-plus"></i> New File
                </button>
            </div>
            <h1>Welcome to File Explorer</h1>
            <p>Select a file from the sidebar to view its contents.</p>
        </main>
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" id="contextNewFolder">
            <i class="fas fa-folder-plus"></i> New Folder
        </div>
        <div class="context-menu-item" id="contextNewFile">
            <i class="fas fa-file-circle-plus"></i> New File
        </div>
        <div class="context-menu-item" id="contextRename">
            <i class="fas fa-pen-to-square"></i> Rename
        </div>
        <div class="context-menu-item" id="contextDelete">
            <i class="fas fa-trash"></i> Delete
        </div>
    </div>

    <!-- New Folder Modal -->
    <div class="modal" id="newFolderModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Create New Folder</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="folderName">Folder Name</label>
                <input type="text" id="folderName" placeholder="Enter folder name">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancel</button>
                <button class="btn btn-primary" id="createFolderBtn">Create</button>
            </div>
        </div>
    </div>

    <!-- New File Modal -->
    <div class="modal" id="newFileModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Create New File</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="fileName">File Name</label>
                <input type="text" id="fileName" placeholder="Enter file name (include extension)">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancel</button>
                <button class="btn btn-primary" id="createFileBtn">Create</button>
            </div>
        </div>
    </div>

    <!-- Rename Modal -->
    <div class="modal" id="renameModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Rename Item</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="newName">New Name</label>
                <input type="text" id="newName" placeholder="Enter new name">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancel</button>
                <button class="btn btn-primary" id="renameBtn">Rename</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Sample file structure data
            let files = [
                {
                    id: '1',
                    name: "Documents",
                    type: "folder",
                    icon: "fa-folder",
                    children: [
                        {
                            id: '1-1',
                            name: "Work",
                            type: "folder",
                            icon: "fa-folder",
                            children: [
                                { id: '1-1-1', name: "Project A.docx", type: "file", icon: "fa-file-word" },
                                { id: '1-1-2', name: "Project B.xlsx", type: "file", icon: "fa-file-excel" }
                            ]
                        },
                        {
                            id: '1-2',
                            name: "Personal",
                            type: "folder",
                            icon: "fa-folder",
                            children: [
                                { id: '1-2-1', name: "Resume.pdf", type: "file", icon: "fa-file-pdf" },
                                { id: '1-2-2', name: "Notes.txt", type: "file", icon: "fa-file-alt" }
                            ]
                        }
                    ]
                },
                {
                    id: '2',
                    name: "Pictures",
                    type: "folder",
                    icon: "fa-folder",
                    children: [
                        {
                            id: '2-1',
                            name: "Vacation",
                            type: "folder",
                            icon: "fa-folder",
                            children: [
                                { id: '2-1-1', name: "Beach.jpg", type: "file", icon: "fa-file-image" },
                                { id: '2-1-2', name: "Mountains.png", type: "file", icon: "fa-file-image" }
                            ]
                        },
                        { id: '2-2', name: "Profile.jpg", type: "file", icon: "fa-file-image" }
                    ]
                },
                { id: '3', name: "README.md", type: "file", icon: "fa-file-code" }
            ];

            // DOM Elements
            const fileTreeElement = document.getElementById('fileTree');
            const contextMenu = document.getElementById('contextMenu');
            const newFolderModal = document.getElementById('newFolderModal');
            const newFileModal = document.getElementById('newFileModal');
            const renameModal = document.getElementById('renameModal');
            const folderNameInput = document.getElementById('folderName');
            const fileNameInput = document.getElementById('fileName');
            const newNameInput = document.getElementById('newName');
            const closeModalButtons = document.querySelectorAll('.close-modal');
            const newFolderBtn = document.getElementById('newFolderBtn');
            const newFileBtn = document.getElementById('newFileBtn');
            const createFolderBtn = document.getElementById('createFolderBtn');
            const createFileBtn = document.getElementById('createFileBtn');
            const renameBtn = document.getElementById('renameBtn');
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            const sidebar = document.querySelector('.sidebar');
            const breadcrumb = document.getElementById('breadcrumb');

            // State variables
            let selectedItem = null;
            let selectedParent = null;
            let currentAction = null; // 'folder', 'file', 'rename'
            let currentPath = []; // To track the current path in the file structure

            // Function to generate unique ID
            function generateId() {
                return Math.random().toString(36).substr(2, 9);
            }

            // Function to render the file tree
            function renderFileTree(data, parentElement) {
                parentElement.innerHTML = '';
                data.forEach(item => {
                    const li = document.createElement('li');
                    
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'file-tree-item';
                    itemDiv.innerHTML = `
                        <i class="fas ${item.icon}"></i>
                        <span>${item.name}</span>
                        ${item.type === 'folder' ? '<i class="fas fa-chevron-right toggle"></i>' : ''}
                    `;
                    
                    li.appendChild(itemDiv);
                    
                    if (item.type === 'folder' && item.children) {
                        const childrenUl = document.createElement('ul');
                        childrenUl.className = 'file-tree-children';
                        renderFileTree(item.children, childrenUl);
                        li.appendChild(childrenUl);
                        
                        // Add click event to toggle folder
                        itemDiv.addEventListener('click', function(e) {
                            e.stopPropagation();
                            this.classList.toggle('active');
                            const toggleIcon = this.querySelector('.toggle');
                            const children = this.parentElement.querySelector('.file-tree-children');
                            
                            if (children.classList.contains('show')) {
                                children.classList.remove('show');
                                toggleIcon.classList.remove('fa-chevron-down');
                                toggleIcon.classList.add('fa-chevron-right');
                            } else {
                                children.classList.add('show');
                                toggleIcon.classList.remove('fa-chevron-right');
                                toggleIcon.classList.add('fa-chevron-down');
                                updateBreadcrumb(item);
                            }
                        });
                        
                        // Right-click context menu
                        itemDiv.addEventListener('contextmenu', function(e) {
                            e.preventDefault();
                            selectedItem = item;
                            selectedParent = data;
                            showContextMenu(e.pageX, e.pageY);
                        });
                    } else {
                        // Add click event for files
                        itemDiv.addEventListener('click', function() {
                            document.querySelectorAll('.file-tree-item').forEach(el => {
                                el.classList.remove('active');
                            });
                            this.classList.add('active');
                            document.querySelector('.content h1').textContent = item.name;
                            document.querySelector('.content p').textContent = `You selected: ${item.name}`;
                        });
                        
                        // Right-click context menu for files
                        itemDiv.addEventListener('contextmenu', function(e) {
                            e.preventDefault();
                            selectedItem = item;
                            selectedParent = data;
                            showContextMenu(e.pageX, e.pageY);
                        });
                    }
                    
                    parentElement.appendChild(li);
                });
            }

            // Function to update breadcrumb
            function updateBreadcrumb(item) {
                currentPath.push(item);
                breadcrumb.innerHTML = currentPath.map((folder, index) => `
                    <div class="breadcrumb-item ${index === currentPath.length - 1 ? 'active' : ''}">
                        ${folder.name}
                    </div>
                    ${index < currentPath.length - 1 ? '<div class="breadcrumb-separator">/</div>' : ''}
                `).join('');
            }

            // Function to show context menu
            function showContextMenu(x, y) {
                contextMenu.style.display = 'block';
                contextMenu.style.left = `${x}px`;
                contextMenu.style.top = `${y}px`;
            }

            // Function to hide context menu
            function hideContextMenu() {
                contextMenu.style.display = 'none';
            }

            // Event listeners for context menu actions
            document.getElementById('contextNewFolder').addEventListener('click', function() {
                currentAction = 'folder';
                hideContextMenu();
                folderNameInput.value = '';
                newFolderModal.style.display = 'flex';
            });

            document.getElementById('contextNewFile').addEventListener('click', function() {
                currentAction = 'file';
                hideContextMenu();
                fileNameInput.value = '';
                newFileModal.style.display = 'flex';
            });

            document.getElementById('contextRename').addEventListener('click', function() {
                currentAction = 'rename';
                hideContextMenu();
                newNameInput.value = selectedItem.name;
                renameModal.style.display = 'flex';
            });

            document.getElementById('contextDelete').addEventListener('click', function() {
                hideContextMenu();
                if (selectedParent) {
                    selectedParent.splice(selectedParent.indexOf(selectedItem), 1);
                    renderFileTree(files, fileTreeElement);
                }
            });

            // Create new folder
            createFolderBtn.addEventListener('click', function() {
                const folderName = folderNameInput.value.trim();
                if (folderName) {
                    const newFolder = {
                        id: generateId(),
                        name: folderName,
                        type: "folder",
                        icon: "fa-folder",
                        children: []
                    };
                    selectedParent.push(newFolder);
                    renderFileTree(files, fileTreeElement);
                    newFolderModal.style.display = 'none';
                }
            });

            // Create new file
            createFileBtn.addEventListener('click', function() {
                const fileName = fileNameInput.value.trim();
                if (fileName) {
                    const newFile = {
                        id: generateId(),
                        name: fileName,
                        type: "file",
                        icon: "fa-file-alt"
                    };
                    selectedParent.push(newFile);
                    renderFileTree(files, fileTreeElement);
                    newFileModal.style.display = 'none';
                }
            });

            // Rename item
            renameBtn.addEventListener('click', function() {
                const newName = newNameInput.value.trim();
                if (newName) {
                    selectedItem.name = newName;
                    renderFileTree(files, fileTreeElement);
                    renameModal.style.display = 'none';
                }
            });

            // Close modals
            closeModalButtons.forEach(button => {
                button.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });

            // Initialize the file tree
            renderFileTree(files, fileTreeElement);

            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', function() {
                sidebar.classList.toggle('show');
            });

            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 768 && 
                    !sidebar.contains(e.target) && 
                    e.target !== mobileMenuBtn && 
                    !mobileMenuBtn.contains(e.target)) {
                    sidebar.classList.remove('show');
                }
            });

            // Hide context menu on click outside
            document.addEventListener('click', function() {
                hideContextMenu();
            });

            // Hide context menu on window resize
            window.addEventListener('resize', function() {
                hideContextMenu();
            });
        });
    </script>
</body>
</html>
