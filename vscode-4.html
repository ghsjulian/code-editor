<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Code Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.14/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.14/ext-language_tools.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
     <link href="css/tailwind.min.css" rel="stylesheet" />
        <script src="libs/ace.js"></script>
        <script src="libs/ext-language_tools.js"></script>
        <link href="css/custom.styles.css" rel="stylesheet" />
        <link href="css/file.explorer.css" rel="stylesheet" />
    <style>
        #editor { 
            width: 100%;
            height: calc(100vh - 8rem);
        }
        .sidebar {
            transition: width 0.3s ease;
        }
        .tree-node {
            cursor: pointer;
            user-select: none;
        }
        .tree-node:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .tab.active {
            background-color: #1e293b;
            color: white;
        }
        .tab:hover {
            background-color: #334155;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="flex flex-col h-screen">
        <!-- Header with Tabs -->
        <div class="bg-gray-800 h-12 flex items-center px-2 overflow-x-auto">
            <div id="tabs" class="flex space-x-1"></div>
        </div>

        <!-- Main Content -->
        <div class="flex flex-1 overflow-hidden">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar bg-gray-800 w-64 flex flex-col">
                <div class="p-4">
                    <button id="toggle-sidebar" class="text-white mb-4">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <div class="flex space-x-2 mb-4">
                        <button id="new-file" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded">New File</button>
                        <button id="new-folder" class="bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded">New Folder</button>
                    </div>
                    <div id="file-tree" class="text-sm"></div>
                </div>
            </div>

            <!-- Editor Area -->
            <div class="flex-1 p-4">
                <div id="editor"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Ace Editor
        const editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/javascript");
        editor.setOptions({
            enableBasicAutocompletion: true,
            enableSnippets: true,
            enableLiveAutocompletion: true
        });

        // File System Structure
        let fileSystem = {
            name: "root",
            type: "folder",
            children: [
                { name: "index.js", type: "file", content: "// Start coding here" },
                { name: "src", type: "folder", children: [
                    { name: "app.js", type: "file", content: "console.log('Hello World');" }
                ]}
            ]
        };

        let openTabs = [];
        let activeTab = null;

        // DOM Elements
        const fileTree = document.getElementById("file-tree");
        const tabsContainer = document.getElementById("tabs");
        const sidebar = document.getElementById("sidebar");
        const toggleSidebar = document.getElementById("toggle-sidebar");
        const newFileBtn = document.getElementById("new-file");
        const newFolderBtn = document.getElementById("new-folder");

        // Render File Tree
        function renderFileTree(node, parentElement, path = "") {
            const div = document.createElement("div");
            div.className = "ml-2";
            const item = document.createElement("div");
            item.className = "tree-node p-1 flex items-center";
            
            if (node.type === "folder") {
                item.innerHTML = `<span class="mr-2">üìÅ</span>${node.name}`;
                const childrenDiv = document.createElement("div");
                childrenDiv.className = "ml-4 hidden";
                item.addEventListener("click", (e) => {
                    e.stopPropagation();
                    childrenDiv.classList.toggle("hidden");
                });
                div.appendChild(item);
                div.appendChild(childrenDiv);
                node.children.forEach(child => renderFileTree(child, childrenDiv, `${path}/${node.name}`));
            } else {
                item.innerHTML = `<span class="mr-2">üìÑ</span>${node.name}`;
                item.addEventListener("click", () => openFile(node, `${path}/${node.name}`));
                div.appendChild(item);
            }
            parentElement.appendChild(div);
        }

        // Open File in Editor
        function openFile(node, path) {
            if (!openTabs.find(tab => tab.path === path)) {
                openTabs.push({ node, path });
                renderTabs();
            }
            setActiveTab(path);
            editor.setValue(node.content || "");
            editor.clearSelection();
        }

        // Render Tabs
        function renderTabs() {
            tabsContainer.innerHTML = "";
            openTabs.forEach(tab => {
                const tabEl = document.createElement("div");
                tabEl.className = `tab px-4 py-2 cursor-pointer ${activeTab === tab.path ? "active" : ""}`;
                tabEl.innerText = tab.node.name;
                tabEl.addEventListener("click", () => setActiveTab(tab.path));
                const closeBtn = document.createElement("span");
                closeBtn.className = "ml-2";
                closeBtn.innerHTML = "√ó";
                closeBtn.addEventListener("click", (e) => {
                    e.stopPropagation();
                    closeTab(tab.path);
                });
                tabEl.appendChild(closeBtn);
                tabsContainer.appendChild(tabEl);
            });
        }

        // Set Active Tab
        function setActiveTab(path) {
            activeTab = path;
            const tab = openTabs.find(t => t.path === path);
            if (tab) {
                editor.setValue(tab.node.content || "");
                editor.clearSelection();
                renderTabs();
            }
        }

        // Close Tab
        function closeTab(path) {
            openTabs = openTabs.filter(tab => tab.path !== path);
            if (activeTab === path) {
                activeTab = openTabs.length > 0 ? openTabs[0].path : null;
                editor.setValue(activeTab ? openTabs[0].node.content : "");
            }
            renderTabs();
        }

        // Create New File
        newFileBtn.addEventListener("click", () => {
            const name = prompt("Enter file name:");
            if (name) {
                fileSystem.children.push({ name, type: "file", content: "" });
                refreshFileTree();
            }
        });

        // Create New Folder
        newFolderBtn.addEventListener("click", () => {
            const name = prompt("Enter folder name:");
            if (name) {
                fileSystem.children.push({ name, type: "folder", children: [] });
                refreshFileTree();
            }
        });

        // Toggle Sidebar
        let isSidebarOpen = true;
        toggleSidebar.addEventListener("click", () => {
            isSidebarOpen = !isSidebarOpen;
            sidebar.style.width = isSidebarOpen ? "16rem" : "0";
            sidebar.style.minWidth = isSidebarOpen ? "16rem" : "0";
        });

        // Refresh File Tree
        function refreshFileTree() {
            fileTree.innerHTML = "";
            renderFileTree(fileSystem, fileTree);
        }

        // Save Editor Content to Active Tab
        editor.on("change", () => {
            if (activeTab) {
                const tab = openTabs.find(t => t.path === activeTab);
                if (tab) tab.node.content = editor.getValue();
            }
        });

        // Initial Render
        refreshFileTree();
    </script>
</body>
</html>